<html>
  <head>
    <title>数组网 - 彪悍的Demo无需解释</title>
    <link href="/css/site.css" rel="stylesheet">
    <script src="/js/less-3.8.0.min.js"></script>
    <link href="/css/github-markdown-2.10.0.css" rel="stylesheet">
    <script src="/js/markdown-0.5.0.js"></script>
  </head>
  <body>
    <div id="header">
      <div class="site-slogan">彪悍的Demo无须解释</div>
      <div><span class="site-name"><a href="/">数组网</a></span><span class="site-url"><a href="shuzu.org">shuzu.org</a></span></div>
    </div>
    <div id="main">
      <div id="repo-main">
        <div class="navigation"><span><a href="/">数组网</a></span><span> &gt; </span><span class="org-link"><a href="/orgs/java-demos/index.html">java-demos</a></span><span> &gt; </span><span class="repo-name">jdb-debugging-demo</span><span class="repo-description">Use a command line tool `jdb` to remote debugging a java application</span></div>
        <div id="readme">
          <div class="markdown markdown-body">Remote debugging with command line tool `jdb`
=============================================

Normally we use IDE for remote debugging a Java application, but it's also possible to use a command line tool to do this.

There is a `jdb` tool included in the JDK: http://docs.oracle.com/javase/7/docs/technotes/tools/windows/jdb.html

Server side
------------

We should compile and run the Java file first.

When compiling the Java source, we need to pass `-g` to keep local varible names for debugging (otherwise the names will be changed to some shorter names).

```
javac -g HelloWorld.java
```

Then run it with enabling remote debugging:

```
java -Xdebug -Xrunjdwp:transport=dt_socket,server=y,address=9999 HelloWorld
```

It:

- listenning on port `9999`
- won't run any code until client connect (`server=y`)

Client side
-----------

```
$ jdb -attach 9999
Set uncaught java.lang.Throwable
Set deferred uncaught java.lang.Throwable
Initializing jdb ...
&gt;
VM Started: No frames on the current call stack

```

Also we can speicify the ip to connect a remote host:

```
jdb -attach &lt;some-ip&gt;:&lt;port&gt;
```

Set a breakpoint:

```
main[1] stop at HelloWorld:4
Deferring breakpoint HelloWorld:4.
It will be set after the class is loaded.
```

Run to the (next) breakpoint:

```
main[1] next
&gt; Set deferred breakpoint HelloWorld:4

Breakpoint hit: &quot;thread=main&quot;, HelloWorld.main(), line=4 bci=3
4           name = &quot;BBB&quot;;
```

Print a varible value:

```
main[1] print name
 name = &quot;AAA&quot;
```

Run to the next line:

```
main[1] step
&gt;
Step completed: &quot;thread=main&quot;, HelloWorld.main(), line=5 bci=6
5           name = &quot;CCC&quot;;
```

Print the `name` variable again:

```
main[1] print name
 name = &quot;BBB&quot;
```

Next breakpoint (actually run to end now):

```
main[1] next
&gt;
Step completed: &quot;thread=main&quot;, HelloWorld.main(), line=6 bci=9
6           System.out.println(name);
```

Show threads:

```
main[1] threads
Group system:
  (java.lang.ref.Reference$ReferenceHandler)0x14d Reference Handler cond. waiting
  (java.lang.ref.Finalizer$FinalizerThread)0x14c  Finalizer         cond. waiting
  (java.lang.Thread)0x14b                         Signal Dispatcher running
Group main:
  (java.lang.Thread)0x1                           main              running
main[1]
```



</div>
        </div>
        <div class="code-file panel markdown-body">
          <div class="header">
            <div class="name"><a href="https://github.com/java-demos/jdb-debugging-demo/blob/master/HelloWorld.java" target="_blank">HelloWorld.java</a></div>
            <div class="path">HelloWorld.java</div>
          </div>
          <div class="body">
            <pre class="content"><code class="java">class HelloWorld {
	public static void main(String[] args) throws Exception {
		String name = &quot;AAA&quot;;
		name = &quot;BBB&quot;;
		name = &quot;CCC&quot;;
		System.out.println(name);
	}
}</code></pre>
          </div>
        </div>
        <div class="github markdown-body"><span class="github-icon"><img src="/images/github.jpg"></span><span class="repo-url"><a href="https://github.com/java-demos/jdb-debugging-demo">打开Github项目地址</a></span><span class="repo-issues"><a href="https://github.com/java-demos/jdb-debugging-demo/issues?q=">有问题上Github Issues上讨论</a></span></div>
      </div>
    </div>
    <script src="/js/site.js"></script>
  </body>
</html>
