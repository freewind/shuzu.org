<html>
  <head>
    <title>数组网 - 彪悍的Demo无需解释</title>
    <link href="/css/site.css" rel="stylesheet">
    <script src="/js/less-3.8.0.min.js"></script>
    <link href="/css/github-markdown-2.10.0.css" rel="stylesheet">
    <script src="/js/showdown-1.8.6.min.js"></script>
  </head>
  <body>
    <div id="header">
      <div class="site-slogan">彪悍的Demo无须解释</div>
      <div><span class="site-name"><a href="/">数组网</a></span><span class="site-url"><a href="shuzu.org">shuzu.org</a></span></div>
    </div>
    <div id="main">
      <div id="repo-main">
        <div class="navigation"><span><a href="/">数组网</a></span><span> &gt; </span><span class="org-link"><a href="/orgs/kotlin-demos/index.html">kotlin-demos</a></span><span> &gt; </span><span class="repo-name">kotlin-kvision-hello-world-demo</span><span class="repo-description"></span></div>
        <div id="readme">
          <div class="markdown markdown-body">KVision Hello World Demo
========================

```
./gradlew -t run
```

Then open &lt;http://localhost:8088&gt;
</div>
        </div>
        <div class="code-file panel markdown-body">
          <div class="header">
            <div class="name"><a href="https://github.com/kotlin-demos/kotlin-kvision-hello-world-demo/blob/master/build.gradle" target="_blank">build.gradle</a></div>
            <div class="path">build.gradle</div>
          </div>
          <div class="body">
            <pre class="content"><code class="gradle">buildscript {
    ext.kotlin_version = '1.2.31'
    ext.kvision_version = '0.0.11'
    ext.frontend_plugin_version = '0.0.29'
    ext.detekt_version = '1.0.0.RC6-4'
    ext.production = (findProperty('prod') ?: 'false') == 'true'
    ext.npmdeps = new File(&quot;npm.dependencies&quot;).getText()

    repositories {
        jcenter()
        maven { url 'https://dl.bintray.com/kotlin/kotlin-eap' }
        maven { url &quot;https://plugins.gradle.org/m2/&quot; }
    }

    dependencies {
        classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version&quot;
        classpath &quot;org.jetbrains.kotlin:kotlin-frontend-plugin:${frontend_plugin_version}&quot;
        classpath &quot;gradle.plugin.io.gitlab.arturbosch.detekt:detekt-gradle-plugin:${detekt_version}&quot;
    }
}

apply plugin: 'kotlin2js'
if (production) {
    apply plugin: 'kotlin-dce-js'
}
apply plugin: 'org.jetbrains.kotlin.frontend'
apply plugin: &quot;io.gitlab.arturbosch.detekt&quot;

repositories {
    jcenter()
    maven { url = 'https://dl.bintray.com/gbaldeck/kotlin' }
    maven { url = 'https://dl.bintray.com/rjaros/kotlin' }
}

dependencies {
    compile &quot;org.jetbrains.kotlin:kotlin-stdlib-js:$kotlin_version&quot;
    compile &quot;org.jetbrains.kotlin:kotlin-test-js:$kotlin_version&quot; // for now only compile configuration is supported
    compile &quot;pl.treksoft:kvision:$kvision_version&quot;
}

kotlinFrontend {
    npm {
        dependency(&quot;css-loader&quot;)
        dependency(&quot;style-loader&quot;)
        dependency(&quot;less&quot;)
        dependency(&quot;less-loader&quot;)
        dependency(&quot;imports-loader&quot;)
        dependency(&quot;uglifyjs-webpack-plugin&quot;)
        dependency(&quot;file-loader&quot;)
        dependency(&quot;url-loader&quot;)
        dependency(&quot;jquery&quot;, &quot;3.2.1&quot;)
        dependency(&quot;fecha&quot;, &quot;2.3.2&quot;)
        dependency(&quot;snabbdom&quot;, &quot;0.7.1&quot;)
        dependency(&quot;snabbdom-virtualize&quot;, &quot;0.7.0&quot;)
        dependency(&quot;navigo&quot;, &quot;7.0.0&quot;)
        npmdeps.eachLine { line -&gt;
            def (name, version) = line.tokenize(&quot; &quot;)
            dependency(name, version)
        }
        devDependency(&quot;karma&quot;)
        devDependency(&quot;karma-qunit&quot;, &quot;1.2.1&quot;)
        devDependency(&quot;karma-chrome-launcher&quot;)
        devDependency(&quot;karma-firefox-launcher&quot;)
        devDependency(&quot;karma-webpack&quot;, &quot;2.0.9&quot;)
        devDependency(&quot;webpack&quot;, &quot;3.11.0&quot;)
        devDependency(&quot;webpack-dev-server&quot;, &quot;2.11.0&quot;)
    }

    webpackBundle {
        bundleName = &quot;main&quot;
        contentPath = file('src/main/web')
    }

    karma {
        plugins = [ &quot;karma-chrome-launcher&quot;, &quot;karma-firefox-launcher&quot; ]
//        browsers = [ &quot;Chrome&quot;, &quot;Firefox&quot; ]
    }
    
    define &quot;PRODUCTION&quot;, production

}

detekt {
    version = &quot;${detekt_version}&quot;
    profile(&quot;main&quot;) {
        input = &quot;$projectDir/src/main/kotlin&quot;
        config = &quot;$projectDir/detekt.yml&quot;
        filters = &quot;.*test.*,.*/resources/.*,.*/tmp/.*&quot;
    }
}

compileKotlin2Js {
    kotlinOptions.metaInfo = true
    kotlinOptions.outputFile = &quot;$project.buildDir.path/js/${project.name}.js&quot;
    kotlinOptions.sourceMap = !production
    kotlinOptions.moduleKind = 'commonjs'
}

compileTestKotlin2Js {
    kotlinOptions.metaInfo = true
    kotlinOptions.outputFile = &quot;$project.buildDir.path/js-tests/${project.name}-tests.js&quot;
    kotlinOptions.sourceMap = !production
    kotlinOptions.moduleKind = 'commonjs'
}

task copyResources(type: Copy) {
    from &quot;src/main/resources&quot;
    into file(buildDir.path + &quot;/js&quot;)
}

task copyResourcesForDce(type: Copy) {
    from &quot;src/main/resources&quot;
    from(&quot;${buildDir.path}/node_modules_imported/kvision&quot;) {
        include &quot;css/**&quot;
        include &quot;img/**&quot;
        include &quot;js/**&quot;
        include &quot;hbs/**&quot;
    }
    into file(buildDir.path + &quot;/kotlin-js-min/main&quot;)
}

task dist(type: Copy, dependsOn: 'bundle') {
    from &quot;src/main/web&quot;
    from &quot;${buildDir.path}/bundle&quot;
    into file(buildDir.path + &quot;/distributions/&quot; + project.name)
}

task distZip(type: Zip, dependsOn: 'dist') {
    from (buildDir.path + &quot;/distributions/&quot; + project.name)
}

afterEvaluate {
    tasks.getByName(&quot;webpack-bundle&quot;) { dependsOn(copyResources, copyResourcesForDce) }
    tasks.getByName(&quot;webpack-run&quot;) { dependsOn(copyResources) }
    tasks.getByName(&quot;karma-start&quot;) { dependsOn(copyResources) }
}
</code></pre>
          </div>
        </div>
        <div class="code-file panel markdown-body">
          <div class="header">
            <div class="name"><a href="https://github.com/kotlin-demos/kotlin-kvision-hello-world-demo/blob/master/karma.config.d/placeholder.js" target="_blank">placeholder.js</a></div>
            <div class="path">karma.config.d/placeholder.js</div>
          </div>
          <div class="body">
            <pre class="content"><code class="js"></code></pre>
          </div>
        </div>
        <div class="code-file panel markdown-body">
          <div class="header">
            <div class="name"><a href="https://github.com/kotlin-demos/kotlin-kvision-hello-world-demo/blob/master/settings.gradle" target="_blank">settings.gradle</a></div>
            <div class="path">settings.gradle</div>
          </div>
          <div class="body">
            <pre class="content"><code class="gradle">rootProject.name = 'helloworld'
</code></pre>
          </div>
        </div>
        <div class="code-file panel markdown-body">
          <div class="header">
            <div class="name"><a href="https://github.com/kotlin-demos/kotlin-kvision-hello-world-demo/blob/master/src/main/kotlin/com/example/Helloworld.kt" target="_blank">Helloworld.kt</a></div>
            <div class="path">src/main/kotlin/com/example/Helloworld.kt</div>
          </div>
          <div class="body">
            <pre class="content"><code class="kt">package com.example

import pl.treksoft.kvision.hmr.ApplicationBase
import pl.treksoft.kvision.html.TAG
import pl.treksoft.kvision.html.Tag.Companion.tag
import pl.treksoft.kvision.panel.FlexDir
import pl.treksoft.kvision.panel.FlexJustify
import pl.treksoft.kvision.panel.FlexPanel.Companion.flexPanel
import pl.treksoft.kvision.panel.Root
import pl.treksoft.kvision.require
import pl.treksoft.kvision.utils.px

class Helloworld : ApplicationBase {

    override fun start(state: Map&lt;String, Any&gt;) {
        Root(&quot;helloworld&quot;) {
            flexPanel(FlexDir.ROW, justify = FlexJustify.CENTER) {
                tag(TAG.DIV, &quot;Hello world!&quot;, classes = setOf(&quot;helloworld&quot;)) {
                    marginTop = 50.px
                    fontSize = 50.px
                }
            }
        }
    }

    override fun dispose(): Map&lt;String, Any&gt; {
        return mapOf()
    }

    companion object {
        val css = require(&quot;./css/helloworld.css&quot;)
    }
}
</code></pre>
          </div>
        </div>
        <div class="code-file panel markdown-body">
          <div class="header">
            <div class="name"><a href="https://github.com/kotlin-demos/kotlin-kvision-hello-world-demo/blob/master/src/main/kotlin/com/example/Main.kt" target="_blank">Main.kt</a></div>
            <div class="path">src/main/kotlin/com/example/Main.kt</div>
          </div>
          <div class="body">
            <pre class="content"><code class="kt">package com.example

import pl.treksoft.kvision.hmr.ApplicationBase
import pl.treksoft.kvision.hmr.module
import kotlin.browser.document

fun main(args: Array&lt;String&gt;) {
    var application: ApplicationBase? = null

    val state: dynamic = module.hot?.let { hot -&gt;
        hot.accept()

        hot.dispose { data -&gt;
            data.appState = application?.dispose()
            application = null
        }

        hot.data
    }

    if (document.body != null) {
        application = start(state)
    } else {
        application = null
        document.addEventListener(&quot;DOMContentLoaded&quot;, { application = start(state) })
    }
}

fun start(state: dynamic): ApplicationBase? {
    if (document.getElementById(&quot;helloworld&quot;) == null) return null
    val application = Helloworld()
    @Suppress(&quot;UnsafeCastFromDynamic&quot;)
    application.start(state?.appState ?: emptyMap())
    return application
}

</code></pre>
          </div>
        </div>
        <div class="code-file panel markdown-body">
          <div class="header">
            <div class="name"><a href="https://github.com/kotlin-demos/kotlin-kvision-hello-world-demo/blob/master/src/main/resources/css/helloworld.css" target="_blank">helloworld.css</a></div>
            <div class="path">src/main/resources/css/helloworld.css</div>
          </div>
          <div class="body">
            <pre class="content"><code class="css"></code></pre>
          </div>
        </div>
        <div class="code-file panel markdown-body">
          <div class="header">
            <div class="name"><a href="https://github.com/kotlin-demos/kotlin-kvision-hello-world-demo/blob/master/src/main/web/index.html" target="_blank">index.html</a></div>
            <div class="path">src/main/web/index.html</div>
          </div>
          <div class="body">
            <pre class="content"><code class="html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;
    &lt;title&gt;KVision Helloworld&lt;/title&gt;
    &lt;script type=&quot;text/javascript&quot; src=&quot;main.bundle.js&quot;&gt;&lt;/script&gt;
    &lt;!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries --&gt;
    &lt;!-- WARNING: Respond.js doesn't work if you view the page via file:// --&gt;
    &lt;!--[if lt IE 9]&gt;
    &lt;script src=&quot;https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;https://oss.maxcdn.com/respond/1.4.2/respond.min.js&quot;&gt;&lt;/script&gt;
    &lt;![endif]--&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id=&quot;helloworld&quot;&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
          </div>
        </div>
        <div class="code-file panel markdown-body">
          <div class="header">
            <div class="name"><a href="https://github.com/kotlin-demos/kotlin-kvision-hello-world-demo/blob/master/src/test/kotlin/test/com/example/HelloworldSpec.kt" target="_blank">HelloworldSpec.kt</a></div>
            <div class="path">src/test/kotlin/test/com/example/HelloworldSpec.kt</div>
          </div>
          <div class="body">
            <pre class="content"><code class="kt">package test.com.example

import com.example.Helloworld
import kotlin.browser.document
import kotlin.test.Test
import kotlin.test.assertTrue

class HelloworldSpec : DomSpec {

    @Test
    fun render() {
        run {
            Helloworld().start(mapOf())
            val element = document.getElementById(&quot;helloworld&quot;)
            assertTrue(
                element?.innerHTML?.contains(&quot;Hello world!&quot;) ?: false,
                &quot;Application should render Hello world! text&quot;
            )
        }
    }
}
</code></pre>
          </div>
        </div>
        <div class="code-file panel markdown-body">
          <div class="header">
            <div class="name"><a href="https://github.com/kotlin-demos/kotlin-kvision-hello-world-demo/blob/master/src/test/kotlin/test/com/example/TestUtil.kt" target="_blank">TestUtil.kt</a></div>
            <div class="path">src/test/kotlin/test/com/example/TestUtil.kt</div>
          </div>
          <div class="body">
            <pre class="content"><code class="kt">package test.com.example

import pl.treksoft.jquery.jQuery
import kotlin.browser.document

interface TestSpec {
    fun beforeTest()

    fun afterTest()

    fun run(code: () -&gt; Unit) {
        beforeTest()
        code()
        afterTest()
    }
}

interface DomSpec : TestSpec {

    override fun beforeTest() {
        val fixture = &quot;&lt;div style=\&quot;display: none\&quot; id=\&quot;pretest\&quot;&gt;&quot; +
                &quot;&lt;div id=\&quot;helloworld\&quot;&gt;&lt;/div&gt;&lt;/div&gt;&quot;
        document.body?.insertAdjacentHTML(&quot;afterbegin&quot;, fixture)
    }

    override fun afterTest() {
        val div = document.getElementById(&quot;pretest&quot;)
        div?.remove()
        jQuery(`object` = &quot;.modal-backdrop&quot;).remove()
    }

}
</code></pre>
          </div>
        </div>
        <div class="code-file panel markdown-body">
          <div class="header">
            <div class="name"><a href="https://github.com/kotlin-demos/kotlin-kvision-hello-world-demo/blob/master/webpack.config.d/bootstrap.js" target="_blank">bootstrap.js</a></div>
            <div class="path">webpack.config.d/bootstrap.js</div>
          </div>
          <div class="body">
            <pre class="content"><code class="js">config.module.rules.push({test: /\.(woff|woff2)(\?v=\d+\.\d+\.\d+)?$/, loader: 'url-loader?limit=10000&amp;mimetype=application/font-woff'});
config.module.rules.push({test: /\.ttf(\?v=\d+\.\d+\.\d+)?$/, loader: 'url-loader?limit=10000&amp;mimetype=application/octet-stream'});
config.module.rules.push({test: /\.eot(\?v=\d+\.\d+\.\d+)?$/, loader: 'file-loader'});
config.module.rules.push({test: /\.svg(\?v=\d+\.\d+\.\d+)?$/, loader: 'url-loader?limit=10000&amp;mimetype=image/svg+xml'});
</code></pre>
          </div>
        </div>
        <div class="code-file panel markdown-body">
          <div class="header">
            <div class="name"><a href="https://github.com/kotlin-demos/kotlin-kvision-hello-world-demo/blob/master/webpack.config.d/css.js" target="_blank">css.js</a></div>
            <div class="path">webpack.config.d/css.js</div>
          </div>
          <div class="body">
            <pre class="content"><code class="js">config.module.rules.push({ test: /\.css$/, loader: &quot;style-loader!css-loader&quot; });

</code></pre>
          </div>
        </div>
        <div class="code-file panel markdown-body">
          <div class="header">
            <div class="name"><a href="https://github.com/kotlin-demos/kotlin-kvision-hello-world-demo/blob/master/webpack.config.d/dce.js" target="_blank">dce.js</a></div>
            <div class="path">webpack.config.d/dce.js</div>
          </div>
          <div class="body">
            <pre class="content"><code class="js">config.output.publicPath=&quot;&quot;;
</code></pre>
          </div>
        </div>
        <div class="code-file panel markdown-body">
          <div class="header">
            <div class="name"><a href="https://github.com/kotlin-demos/kotlin-kvision-hello-world-demo/blob/master/webpack.config.d/file.js" target="_blank">file.js</a></div>
            <div class="path">webpack.config.d/file.js</div>
          </div>
          <div class="body">
            <pre class="content"><code class="js">config.module.rules.push(
    {
        test: /\.(jpe?g|png|gif|svg)$/i,
        loader: 'file-loader'
    }
);</code></pre>
          </div>
        </div>
        <div class="code-file panel markdown-body">
          <div class="header">
            <div class="name"><a href="https://github.com/kotlin-demos/kotlin-kvision-hello-world-demo/blob/master/webpack.config.d/handlebars.js" target="_blank">handlebars.js</a></div>
            <div class="path">webpack.config.d/handlebars.js</div>
          </div>
          <div class="body">
            <pre class="content"><code class="js">config.module.rules.push(
    {
        test: /\.hbs$/i,
        loader: 'handlebars-loader'
    }
);</code></pre>
          </div>
        </div>
        <div class="code-file panel markdown-body">
          <div class="header">
            <div class="name"><a href="https://github.com/kotlin-demos/kotlin-kvision-hello-world-demo/blob/master/webpack.config.d/jquery.js" target="_blank">jquery.js</a></div>
            <div class="path">webpack.config.d/jquery.js</div>
          </div>
          <div class="body">
            <pre class="content"><code class="js">config.plugins.push(new webpack.ProvidePlugin({
    $: &quot;jquery&quot;,
    jQuery: &quot;jquery&quot;
}));
</code></pre>
          </div>
        </div>
        <div class="code-file panel markdown-body">
          <div class="header">
            <div class="name"><a href="https://github.com/kotlin-demos/kotlin-kvision-hello-world-demo/blob/master/webpack.config.d/minify.js" target="_blank">minify.js</a></div>
            <div class="path">webpack.config.d/minify.js</div>
          </div>
          <div class="body">
            <pre class="content"><code class="js">if (defined.PRODUCTION) {
    config.plugins.push(new webpack.optimize.UglifyJsPlugin({
    }));
}
</code></pre>
          </div>
        </div>
        <div class="github markdown-body"><span class="github-icon"><img src="/images/github.jpg"></span><span class="repo-url"><a href="https://github.com/kotlin-demos/kotlin-kvision-hello-world-demo">打开Github项目地址</a></span><span class="repo-issues"><a href="https://github.com/kotlin-demos/kotlin-kvision-hello-world-demo/issues?q=">有问题上Github Issues上讨论</a></span></div>
      </div>
    </div>
    <script src="/js/site.js"></script>
  </body>
</html>
