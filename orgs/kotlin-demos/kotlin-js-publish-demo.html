<html>
  <head>
    <title>数组网 - 彪悍的Demo无需解释</title>
    <link href="/css/site.css" rel="stylesheet">
    <script src="/js/less-3.8.0.min.js"></script>
    <link href="/css/github-markdown-2.10.0.css" rel="stylesheet">
    <script src="/js/markdown-0.5.0.js"></script>
  </head>
  <body>
    <div id="header">
      <div class="site-slogan">彪悍的Demo无须解释</div>
      <div><span class="site-name"><a href="/">数组网</a></span><span class="site-url"><a href="shuzu.org">shuzu.org</a></span></div>
    </div>
    <div id="main">
      <div id="repo-main">
        <div class="navigation"><span><a href="/">数组网</a></span><span> &gt; </span><span class="org-link"><a href="/orgs/kotlin-demos/index.html">kotlin-demos</a></span><span> &gt; </span><span class="repo-name">kotlin-js-publish-demo</span><span class="repo-description"></span></div>
        <div id="readme">
          <div class="markdown markdown-body">Kotlin JS Publish Demo
======================

Kotlin-Js project, also publish to jcenter/bintray and npm.

Modify names when copy this project
-----------------------------------

- `README.md`
- `build.gradle`
- `generated/package.json`

Modify version before publishing
--------------------------------

- `README.md`
- `build.gradle`
- `generated/package.json`

Publish
-------

to maven local:

```
./gradlew install
```

to bintray:

```
./gradlew bintrayPublish
```

to npm:

```
cd generated
npm publish
```

Use
---

To use in `build.gradle`:

```
repositories {
    maven {
        url 'https://dl.bintray.com/freewind/maven/'
    }
}

dependencies {
    compile 'freewind.github.com:kotlin-js-publish-demo:0.1.0'
}
```

Also npm:

```
npm install --save kotlin-js-publish-demo
```


</div>
        </div>
        <div class="code-file panel markdown-body">
          <div class="header">
            <div class="name"><a href="https://github.com/kotlin-demos/kotlin-js-publish-demo/blob/master/bintray.gradle" target="_blank">bintray.gradle</a></div>
            <div class="path">bintray.gradle</div>
          </div>
          <div class="body">
            <pre class="content"><code class="gradle">group = publishedGroupId
version = libraryVersion

install {
    repositories.mavenInstaller {
        pom.project {
            packaging 'aar'
            groupId publishedGroupId
            artifactId artifact

            name libraryName
            description libraryName
            url siteUrl

            licenses {
                license {
                    name licenseName
                    url licenseUrl
                }
            }
            developers {
                developer {
                    id developerId
                    name developerName
                    email developerEmail
                }
            }
            scm {
                connection gitUrl
                developerConnection gitUrl
                url siteUrl
            }
        }
    }
}

task sourcesJar(type: Jar, dependsOn: classes) {
    classifier = 'sources'
    from sourceSets.main.allSource
}

task javadocJar(type: Jar, dependsOn: javadoc) {
    classifier = 'javadoc'
    from javadoc.destinationDir
}

artifacts {
    archives javadocJar
    archives sourcesJar
}

Properties properties = new Properties()
properties.load(project.rootProject.file('local.properties').newDataInputStream())

bintray {
    user = properties.getProperty(&quot;bintray.user&quot;)
    key = properties.getProperty(&quot;bintray.apikey&quot;)

    configurations = ['archives']
    pkg {
        repo = repoName
        name = artifact
        desc = libraryName
        websiteUrl = siteUrl
        vcsUrl = gitUrl
        licenses = allLicenses
        dryRun = false
        publish = true
        override = false
        publicDownloadNumbers = true
        version {
            desc = libraryName
        }
    }
}</code></pre>
          </div>
        </div>
        <div class="code-file panel markdown-body">
          <div class="header">
            <div class="name"><a href="https://github.com/kotlin-demos/kotlin-js-publish-demo/blob/master/build.gradle" target="_blank">build.gradle</a></div>
            <div class="path">build.gradle</div>
          </div>
          <div class="body">
            <pre class="content"><code class="gradle">buildscript {
    ext.kotlin_version = '1.2.51'
    repositories {
        mavenLocal()
        maven { url 'http://maven.aliyun.com/nexus/content/groups/public/' }
        maven { url 'http://maven.aliyun.com/nexus/content/repositories/jcenter' }
        jcenter()
        maven { url(&quot;https://plugins.gradle.org/m2/&quot;) }
    }
    dependencies {
        classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version&quot;
        classpath 'com.jfrog.bintray.gradle:gradle-bintray-plugin:1.7.3'
    }
}

apply plugin: 'kotlin2js'
apply plugin: 'maven'
apply plugin: 'com.jfrog.bintray'

ext {
    // have to change
    publishedGroupId = 'freewind.demos'
    // `artifact` also use as and `bintray.pkg.name` for simplifying
    artifact = 'kotlin-js-hello-world-publish-demo'
    libraryVersion = '0.1.0'
    // `libraryName` also uses as `bintray.pkg.libraryName` and `bintray.pkg.version.libraryName`
    libraryName = 'kotlin-js-hello-world-publish-demo'

    siteUrl = 'https://github.com/kotlin-demos/kotlin-js-hello-world-publish-demo'

    // normally no need to change
    repoName = 'maven'

    gitUrl = &quot;${siteUrl}.git&quot;

    developerId = 'freewind'
    developerName = 'Freewind'
    developerEmail = 'nowindlee@gmail.com'

    licenseName = 'The Apache Software License, Version 2.0'
    licenseUrl = 'http://www.apache.org/licenses/LICENSE-2.0.txt'
    allLicenses = [&quot;Apache-2.0&quot;]
}

compileKotlin2Js {
    kotlinOptions.outputFile = &quot;${projectDir}/generated/${artifact}.js&quot;
}

repositories {
    mavenLocal()
    maven { url 'http://maven.aliyun.com/nexus/content/groups/public/' }
    maven { url 'http://maven.aliyun.com/nexus/content/repositories/jcenter' }
    jcenter()
    maven { url 'https://dl.bintray.com/freewind/maven/' }
}

dependencies {
    compile &quot;org.jetbrains.kotlin:kotlin-stdlib-js:$kotlin_version&quot;
    testCompile &quot;org.jetbrains.kotlin:kotlin-test-js:$kotlin_version&quot;
}

apply from: 'bintray.gradle'

// gradle wrapper --gradle-version 4.8.1
// ./gradlew -version
</code></pre>
          </div>
        </div>
        <div class="code-file panel markdown-body">
          <div class="header">
            <div class="name"><a href="https://github.com/kotlin-demos/kotlin-js-publish-demo/blob/master/generated/hello.js" target="_blank">hello.js</a></div>
            <div class="path">generated/hello.js</div>
          </div>
          <div class="body">
            <pre class="content"><code class="js">if (typeof kotlin === 'undefined') {
  throw new Error(&quot;Error loading module 'hello'. Its dependency 'kotlin' was not found. Please, check whether 'kotlin' is loaded prior to 'hello'.&quot;);
}
var hello = function (_, Kotlin) {
  'use strict';
  function main(args) {
    console.log(hello('Kotlin JS'));
  }
  function hello(name) {
    return 'Hello, ' + name + '!';
  }
  var package$example = _.example || (_.example = {});
  package$example.main_kand9s$ = main;
  package$example.hello_61zpoe$ = hello;
  main([]);
  Kotlin.defineModule('hello', _);
  return _;
}(typeof hello === 'undefined' ? {} : hello, kotlin);
</code></pre>
          </div>
        </div>
        <div class="code-file panel markdown-body">
          <div class="header">
            <div class="name"><a href="https://github.com/kotlin-demos/kotlin-js-publish-demo/blob/master/generated/hello.meta.js" target="_blank">hello.meta.js</a></div>
            <div class="path">generated/hello.meta.js</div>
          </div>
          <div class="body">
            <pre class="content"><code class="js">// Kotlin.kotlin_module_metadata(66049, &quot;hello&quot;, &quot;H4sIAAAAAAAAAC3OQQ7CIBQEUKAfSn5cfNnYsPIGNr2A8QzGA7AgtRGoQRZ6DVd6E48nmq7eZGYzzLw57lGefQgzqstcwpRQHUue0oiQXPQI0dUOTmkqCC6PN5SHnN0DW3938Rq82aIgjkozEh37KxfbqiBtd3ZNzIqeD4qanx/N7IagRjGsSFltwNS6b+rw0vDUApld/nwBRFJ09KUAAAA=&quot;);
</code></pre>
          </div>
        </div>
        <div class="code-file panel markdown-body">
          <div class="header">
            <div class="name"><a href="https://github.com/kotlin-demos/kotlin-js-publish-demo/blob/master/index.html" target="_blank">index.html</a></div>
            <div class="path">index.html</div>
          </div>
          <div class="body">
            <pre class="content"><code class="html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Kotlin JS Hello World Demo&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;script type=&quot;text/javascript&quot; src=&quot;node_modules/kotlin/kotlin.js&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot; src=&quot;generated/hello.js&quot;&gt;&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre>
          </div>
        </div>
        <div class="code-file panel markdown-body">
          <div class="header">
            <div class="name"><a href="https://github.com/kotlin-demos/kotlin-js-publish-demo/blob/master/src/main/kotlin/example/Hello.kt" target="_blank">Hello.kt</a></div>
            <div class="path">src/main/kotlin/example/Hello.kt</div>
          </div>
          <div class="body">
            <pre class="content"><code class="kt">package example

fun main(args: Array&lt;String&gt;) {
    console.log(hello(&quot;Kotlin JS&quot;))
}

fun hello(name:String) = &quot;Hello, $name!&quot;

</code></pre>
          </div>
        </div>
        <div class="github markdown-body"><span class="github-icon"><img src="/images/github.jpg"></span><span class="repo-url"><a href="https://github.com/kotlin-demos/kotlin-js-publish-demo">打开Github项目地址</a></span><span class="repo-issues"><a href="https://github.com/kotlin-demos/kotlin-js-publish-demo/issues?q=">有问题上Github Issues上讨论</a></span></div>
      </div>
    </div>
    <script src="/js/site.js"></script>
  </body>
</html>
