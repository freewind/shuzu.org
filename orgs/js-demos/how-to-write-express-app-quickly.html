<html>
  <head>
    <title>数组网 - 彪悍的Demo无需解释</title>
    <link href="/css/site.css" rel="stylesheet">
    <script src="/js/less-3.8.0.min.js"></script>
    <link href="/css/github-markdown-2.10.0.css" rel="stylesheet">
    <script src="/js/markdown-0.5.0.js"></script>
  </head>
  <body>
    <div id="header">
      <div class="site-slogan">彪悍的Demo无须解释</div>
      <div><span class="site-name"><a href="/">数组网</a></span><span class="site-url"><a href="shuzu.org">shuzu.org</a></span></div>
    </div>
    <div id="main">
      <div id="repo-main">
        <div class="navigation"><span><a href="/">数组网</a></span><span> &gt; </span><span class="org-link"><a href="/orgs/js-demos/index.html">js-demos</a></span><span> &gt; </span><span class="repo-name">how-to-write-express-app-quickly</span><span class="repo-description"></span></div>
        <div id="readme">
          <div class="markdown markdown-body">How to write an express application quickly
===========================================

Steps
-----

### create directory, config files and download deps

```
mkdir myapp
cd myapp
npm init -y
npm install express --save
```

### use `nodemon` to auto-reload

```
npm install -g nodemon
```

### write code

The code is already in this project

### run code

```
node index.js
```

or

```
nodemon index.js
```

### visit

```
curl http://localhost:3000/products
curl http://localhost:3000/products/1
curl -X POST -d '{&quot;name&quot;:&quot;Apple&quot;,&quot;price&quot;:3.2}' -H &quot;Content-Type: application/json&quot; http://localhost:3000/products/1
curl http://localhost:3000/version
```

We can use `-v` to see the sending and receiving headers:

```
curl -v http://localhost:3000/version
```</div>
        </div>
        <div class="code-file panel markdown-body">
          <div class="header">
            <div class="name"><a href="https://github.com/js-demos/how-to-write-express-app-quickly/blob/master/about-router.js" target="_blank">about-router.js</a></div>
            <div class="path">about-router.js</div>
          </div>
          <div class="body">
            <pre class="content"><code class="js">var express = require('express');
var router = express.Router();

router.get('/version', function (req, res) {
  res.send('1.1.1');
});

module.exports = router;</code></pre>
          </div>
        </div>
        <div class="code-file panel markdown-body">
          <div class="header">
            <div class="name"><a href="https://github.com/js-demos/how-to-write-express-app-quickly/blob/master/index.js" target="_blank">index.js</a></div>
            <div class="path">index.js</div>
          </div>
          <div class="body">
            <pre class="content"><code class="js">var express = require('express');
var bodyParser = require('body-parser');

var app = express();
app.use(bodyParser.json());

app.use('/products', require('./products-router'));
app.use('/about', require('./about-router'));

var server = app.listen(3000, function () {
  var port = server.address().port;
  console.log(&quot;listen on &quot; + port);
});</code></pre>
          </div>
        </div>
        <div class="code-file panel markdown-body">
          <div class="header">
            <div class="name"><a href="https://github.com/js-demos/how-to-write-express-app-quickly/blob/master/next-id.js" target="_blank">next-id.js</a></div>
            <div class="path">next-id.js</div>
          </div>
          <div class="body">
            <pre class="content"><code class="js">var id = 0;

module.exports = function () {
  id += 1;
  return id;
};
</code></pre>
          </div>
        </div>
        <div class="code-file panel markdown-body">
          <div class="header">
            <div class="name"><a href="https://github.com/js-demos/how-to-write-express-app-quickly/blob/master/products-manager.js" target="_blank">products-manager.js</a></div>
            <div class="path">products-manager.js</div>
          </div>
          <div class="body">
            <pre class="content"><code class="js">var _ = require('lodash');
var nextId = require('./next-id');

var products = [{
  id: nextId(),
  name: 'Cocacola',
  price: 3.5
}];

module.exports = {
  getAll: function () {
    return products;
  },
  get: function (id) {
    return _.find(products, function (item) {
      return item.id === parseInt(id);
    });
  },
  save: function (data) {
    products.push({
      id: nextId(),
      name: data.name,
      price: data.price
    });
  }
};</code></pre>
          </div>
        </div>
        <div class="code-file panel markdown-body">
          <div class="header">
            <div class="name"><a href="https://github.com/js-demos/how-to-write-express-app-quickly/blob/master/products-router.js" target="_blank">products-router.js</a></div>
            <div class="path">products-router.js</div>
          </div>
          <div class="body">
            <pre class="content"><code class="js">var express = require('express');
var productsManager = require('./products-manager');
var bodyParser = require('body-parser');

var router = express.Router();
router.use(bodyParser.json());


router.get('/', function (req, res) {
  res.json(productsManager.getAll());
});

router.post('/', function (req, res) {
  productsManager.save(req.body);
  res.sendStatus(201);
});

router.get('/:id', function (req, res) {
  var found = productsManager.get(req.params.id);
  if (found) {
    res.json(found);
  } else {
    res.sendStatus(404);
  }
});

module.exports = router;</code></pre>
          </div>
        </div>
        <div class="github markdown-body"><span class="github-icon"><img src="/images/github.jpg"></span><span class="repo-url"><a href="https://github.com/js-demos/how-to-write-express-app-quickly">打开Github项目地址</a></span><span class="repo-issues"><a href="https://github.com/js-demos/how-to-write-express-app-quickly/issues?q=">有问题上Github Issues上讨论</a></span></div>
      </div>
    </div>
    <script src="/js/site.js"></script>
    <script type="javascript" src="https://s13.cnzz.com/z_stat.php?id=1274292847&amp;web_id=1274292847"></script>
  </body>
</html>
